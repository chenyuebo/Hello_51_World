# Hello_51_World
公司赛码比赛，参赛代码。因小组内有两名IOS开发人员，为了方便交流，所以使用Objective-C开发，OC只学了两周左右，项目中如有不合适的还请谅解指正。

# 赛码内容

## 1. 题目
公司即将上线5组业务功能相同的新渠道C1，C2，C3，C4，C5。 5个渠道接口的入参出参均一致（除调用地址不同），接口请求方式为http get。5个渠道的调用成本和性能（成功率及响应耗时）略微不同，成本高的渠道响应快，成功率高。公司计划对上述5个渠道开放10分钟试运营时间，邀请参赛队设计一个调度系统，在试运营的10分钟内调度30000个指令到上述5个渠道，综合成功率／营收／成本／服务处理时间等指标打分，得分最高的系统获胜。

## 2. 试运营期间系统规则
A. 参赛系统维度限流。 每个参赛队一秒内允许发送单渠道20个请求。超过该请求数，该渠道系统将拒绝请求并记录调用成本，详见收入／成本表格。允许参赛系统并发多渠道。例如，参赛系统T1可以在一秒内并发100个请求到5个渠道。  

B. 5个渠道累积不可用时间总和为10分钟。5个渠道在试运营的第一分钟内均正常工作，后续的9分钟可能在不同的时间区间返回系统失败。例如C1可能在第6-7分钟内返回系统错误，C5可能在第2.5-4.5分钟内返回系统失败等。

C. 如渠道返回指令处理失败，参赛系统可以重试该指令。如渠道返回处理成功，参赛系统重试该指令，将被视为重复请求进行扣分。详见计分规则。

D. 渠道接口最慢处理时间不超过5秒。

E. 系统试运营时间以请求到达渠道服务时间为准。例如C1在试运营结束前最后一毫秒接收到了参赛系统T1发送的请求，即使该请求处理耗时5秒，服务仍将完成处理并将其纳入T1的统计得分。

F. 参赛系统为单节点部署，无数据库。渠道调用地址，系统试运营时间，参赛系统令牌等参数建议参赛系统可配置。
## 3. 指令接口
渠道指令接口通讯方式http get，参数如下
| 请求参数   | 格式        | 描述                                                       |
| :-------- |:-----------:| :---------------------------------------------------------|
| reqNo     | Number(5)   | 指令编号为阿拉伯数字1-30000，不补0。 例如发送指令1，则reqNo=1 |
| token     | String(10)  | 参数系统令牌。比赛10分钟前发放各参赛队令牌。                  |

渠道地址及接口示例  
C1 http://cc.intra.yacolpay.com/c1/apply.htm?reqNo=1&token=xxxx  
C2 http://cc.intra.yacolpay.com/c2/apply.htm?reqNo=199&token=xxxx  
C3 http://cc.intra.yacolpay.com/c3/apply.htm?reqNo=299&token=xxxx  
C4 http://cc.intra.yacolpay.com/c4/apply.htm?reqNo=399&token=xxxx  
C5 http://cc.intra.yacolpay.com/c5/apply.htm?reqNo=499&token=xxxx

## 4. 响应码及状态描述
| http响应状态 | 响应内容            | 描述                                                                              |
|:-----------:|:-------------------|:----------------------------------------------------------------------------------|
|200          |	Number(10)         | 服务在指令处理成功后，返回该指令的处理时间。单位为毫秒，例：1500，表示本次处理时间为1.5秒 |
|400          |	DUPLICATE_REQUEST  | 重复请求                                                                           |
|401          |	INVALID_REQUEST    | 请求校验失败                                                                       |
|403          |	SERVICE_REJECT     | 服务限流                                                                           |
|500          |	SERVICE_BUSY       | 系统繁忙                                                                           |
|502          |	UNKNOW             | 其他失败                                                                           |
## 5. 计分规则
**参赛系统最终得分 = A得分+B扣分+C附加分**  
A. 服务返回指令成功（响应码200），参赛系统+20分，扣去渠道调用成本后为该次请求的总得分。渠道成本如下表，例如参赛系统T1发送指令1到C2，获得响应http200,则该次请求得分为20-12=8 
| 渠道名称 | 成本     |
|:-------:|:---------|
|C1       | 12分／笔 |
|C2       | 11分／笔 |
|C3       | 10分／笔 |
|C4       | 9分／笔  |
|C5       | 8分／笔  |
 
B. 若服务响应码非200，则该次请求不加分，不计渠道成本，并根据下表的规则进行扣分
| http状态码 | 描述                                         | 扣分情况 |
|:---------:|:---------------------------------------------|:-------:|
|400        | 重复请求，指重复提交服务端已经处理并返回200的指令| -20     |
|401        | 请求校验失败                                  | -5      |
|403        | 服务限流                                      | -10     |
|500        | 系统繁忙                                      | -5      |
|502        | 未知错误                                      | 0 不扣分|
 
C. 附加分  
若如下指标的排名在前三名，则赠送附加分。

平均处理时间： 服务器在每个指令处理成功后返回该指令的处理时间，成功订单平均处理时间最少者排名第一

成功率：成功率 = 终态为响应码200的指令总数／30000

指令终态为运营有效时间内该指令最后一次的系统处理状态。例如：指令1前N次调用系统繁忙，最后一次调用返回状态码200，则该指令终态为200。
 
| 名次 | 平均处理时间 |	成功率 （成功率为100%的参数系统额外获得10000分奖励）|
|:----:|:-----------|:-------------------------------------------------|
|1     | +50000分   | 10000                                            |
|2     | +20000分   | 8000                                             |
|3     | +10000分   | 5000                                             |
注意：成功率100%的参赛系统额外获得10000分激励。
